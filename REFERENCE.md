# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`profile_audit`](#profile_audit): A short summary of the purpose of this class
* [`profile_audit::net_process_log`](#profile_audit--net_process_log): Logs user processes and open network connections to syslog
* [`profile_audit::qualys`](#profile_audit--qualys): Configure host to be scanned by qualys
* [`profile_audit::qualys_eus_reporting`](#profile_audit--qualys_eus_reporting): Remove old, historical wrapper for subscription-manager to lie about enabled repos.
This only cleans up old files that are no longer needed.
See SVCPLAN-5381 & SVC-12072 for historical details.
Once all NCSA hosts have removed these files this class can go away.
* [`profile_audit::root_equivalence`](#profile_audit--root_equivalence): Configure root equivalence reporting
* [`profile_audit::vetting`](#profile_audit--vetting): Install and configure a security vetting script

## Classes

### <a name="profile_audit"></a>`profile_audit`

A description of what this class does

#### Examples

##### 

```puppet
include profile_audit
```

### <a name="profile_audit--net_process_log"></a>`profile_audit::net_process_log`

Logs user processes and open network connections to syslog

#### Examples

##### 

```puppet
include profile_audit::net_process_log
```

#### Parameters

The following parameters are available in the `profile_audit::net_process_log` class:

* [`enable_net_process_log`](#-profile_audit--net_process_log--enable_net_process_log)
* [`ignore_users`](#-profile_audit--net_process_log--ignore_users)
* [`ps_arg`](#-profile_audit--net_process_log--ps_arg)
* [`ss_arg`](#-profile_audit--net_process_log--ss_arg)
* [`ss_filter`](#-profile_audit--net_process_log--ss_filter)
* [`minute_interval`](#-profile_audit--net_process_log--minute_interval)

##### <a name="-profile_audit--net_process_log--enable_net_process_log"></a>`enable_net_process_log`

Data type: `Boolean`

Enable/disable the net_process_log logging

##### <a name="-profile_audit--net_process_log--ignore_users"></a>`ignore_users`

Data type: `String`

String to pass to net_process_log.pl script as -i argument.
Setting to empty string will use default defined in net_process_log.pl.
Format is a csv of users to ignore. Example : "root,chrony,dbus".

##### <a name="-profile_audit--net_process_log--ps_arg"></a>`ps_arg`

Data type: `String`

String to pass to net_process_log.pl script as --psarg argument.
Setting to empty string will use default defined in net_process_log.pl.

##### <a name="-profile_audit--net_process_log--ss_arg"></a>`ss_arg`

Data type: `String`

String to pass to net_process_log.pl script as --ssarg argument.
Setting to empty string will use default defined in net_process_log.pl

##### <a name="-profile_audit--net_process_log--ss_filter"></a>`ss_filter`

Data type: `String`

String to pass to net_process_log.pl script as --ssfilter argument.
Setting to empty string will use default defined in net_process_log.pl

##### <a name="-profile_audit--net_process_log--minute_interval"></a>`minute_interval`

Data type: `String`

Value to use in the minute field of the cron task

### <a name="profile_audit--qualys"></a>`profile_audit::qualys`

See https://wiki.ncsa.illinois.edu/display/SecOps/Qualys+Authenticated+Scanning+Host+setup

#### Examples

##### 

```puppet
include profile_audit::qualys
```

#### Parameters

The following parameters are available in the `profile_audit::qualys` class:

* [`enabled`](#-profile_audit--qualys--enabled)
* [`escalated_scans`](#-profile_audit--qualys--escalated_scans)
* [`escalated_scan_sudocfg`](#-profile_audit--qualys--escalated_scan_sudocfg)
* [`gid`](#-profile_audit--qualys--gid)
* [`group`](#-profile_audit--qualys--group)
* [`homedir`](#-profile_audit--qualys--homedir)
* [`ip`](#-profile_audit--qualys--ip)
* [`ssh_authorized_key`](#-profile_audit--qualys--ssh_authorized_key)
* [`ssh_authorized_key_type`](#-profile_audit--qualys--ssh_authorized_key_type)
* [`sshd_custom_cfg`](#-profile_audit--qualys--sshd_custom_cfg)
* [`subgid_file`](#-profile_audit--qualys--subgid_file)
* [`subuid_file`](#-profile_audit--qualys--subuid_file)
* [`uid`](#-profile_audit--qualys--uid)
* [`user`](#-profile_audit--qualys--user)
* [`user_comment`](#-profile_audit--qualys--user_comment)

##### <a name="-profile_audit--qualys--enabled"></a>`enabled`

Data type: `Boolean`

Boolean to define if authenticated qualys scan enabled

##### <a name="-profile_audit--qualys--escalated_scans"></a>`escalated_scans`

Data type: `Boolean`

Boolean to define if qualys should be allowed to sudo to root for escalated scans

##### <a name="-profile_audit--qualys--escalated_scan_sudocfg"></a>`escalated_scan_sudocfg`

Data type: `String`

String setting qualys sudo config

##### <a name="-profile_audit--qualys--gid"></a>`gid`

Data type: `String`

String of the GID of the local qualys user

##### <a name="-profile_audit--qualys--group"></a>`group`

Data type: `String`

String of the group name of the local qualys user

##### <a name="-profile_audit--qualys--homedir"></a>`homedir`

Data type: `String`

String of the home directory path of the local qualys user

##### <a name="-profile_audit--qualys--ip"></a>`ip`

Data type: `String`

String of the IP address that the qualys user can login from

##### <a name="-profile_audit--qualys--ssh_authorized_key"></a>`ssh_authorized_key`

Data type: `Optional[String]`

String of the public ssh authorized key that the qualys user uses for authentication

##### <a name="-profile_audit--qualys--ssh_authorized_key_type"></a>`ssh_authorized_key_type`

Data type: `String`

String of the key type used for the qualys user's authentication

##### <a name="-profile_audit--qualys--sshd_custom_cfg"></a>`sshd_custom_cfg`

Data type: `Hash`

Hash of additional sshd match parameters for matchblock for qualys access

##### <a name="-profile_audit--qualys--subgid_file"></a>`subgid_file`

Data type: `String`

Path to subgid file if supported by OS

##### <a name="-profile_audit--qualys--subuid_file"></a>`subuid_file`

Data type: `String`

Path to subuid file if supported by OS

##### <a name="-profile_audit--qualys--uid"></a>`uid`

Data type: `String`

String of the UID of the local qualys user

##### <a name="-profile_audit--qualys--user"></a>`user`

Data type: `String`

String of the username of the local qualys user

##### <a name="-profile_audit--qualys--user_comment"></a>`user_comment`

Data type: `String`

String of the comment in passwd file of the local qualys user

### <a name="profile_audit--qualys_eus_reporting"></a>`profile_audit::qualys_eus_reporting`

Remove old, historical wrapper for subscription-manager to lie about enabled repos.
This only cleans up old files that are no longer needed.
See SVCPLAN-5381 & SVC-12072 for historical details.
Once all NCSA hosts have removed these files this class can go away.

#### Examples

##### 

```puppet
include profile_audit::qualys_eus_reporting
```

### <a name="profile_audit--root_equivalence"></a>`profile_audit::root_equivalence`

See https://wiki.ncsa.illinois.edu/display/SecOps/k5login+root+equivalence+reporting

#### Examples

##### 

```puppet
include profile_audit::root_equivalence
```

#### Parameters

The following parameters are available in the `profile_audit::root_equivalence` class:

* [`crons`](#-profile_audit--root_equivalence--crons)
* [`enable_yum_repo`](#-profile_audit--root_equivalence--enable_yum_repo)
* [`files`](#-profile_audit--root_equivalence--files)
* [`packages`](#-profile_audit--root_equivalence--packages)

##### <a name="-profile_audit--root_equivalence--crons"></a>`crons`

Data type: `Hash`

Hash of CRON entries for root equivalence reporting

##### <a name="-profile_audit--root_equivalence--enable_yum_repo"></a>`enable_yum_repo`

Data type: `Optional[String]`

Optional yum repo that must be enabled for list of packages to be installed.
This is needed to support enabling the rhel-7-server-optional-rpms repo for RHEL 7.

Default value: `''`

##### <a name="-profile_audit--root_equivalence--files"></a>`files`

Data type: `Hash`

Hash of files (scripts, etc) used for root equivalence reporting

##### <a name="-profile_audit--root_equivalence--packages"></a>`packages`

Data type: `Array`

Array of packages that need to be installed for root equivalence reporting

### <a name="profile_audit--vetting"></a>`profile_audit::vetting`

See https://wiki.ncsa.illinois.edu/display/SecOps/System+Vetting+Procedures
This has not yet been implemented

#### Examples

##### 

```puppet
include profile_audit::vetting
```

